
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
:root{
  --bg:#eef0f5;--white:#fff;--surface:#f7f8fb;--surface2:#eceef4;
  --border:#dde0ea;--border2:#c8ccda;
  --accent:#2563eb;--accent-light:#dbeafe;--accent-hover:#1d4ed8;
  --text:#1e2235;--text2:#4a5072;--muted:#8890aa;
  --success:#15803d;--success-bg:#dcfce7;--success-border:#86efac;
  --danger:#b91c1c;--danger-bg:#fee2e2;--danger-border:#fca5a5;
  --warning:#92400e;--warning-bg:#fef3c7;--warning-border:#fcd34d;
  --purple:#7c3aed;--purple-light:#ede9fe;--purple-border:#c4b5fd;
  --shadow:0 1px 3px rgba(30,34,53,.07),0 1px 2px rgba(30,34,53,.05);
  --shadow-md:0 4px 16px rgba(30,34,53,.09);
  --radius:10px;--radius-sm:6px;
}
html,body{height:100%;font-family:'IBM Plex Sans',sans-serif;background:var(--bg);color:var(--text);display:flex;flex-direction:column;}

/* ── HEADER ── */
header{background:var(--white);border-bottom:1px solid var(--border);padding:0 24px;height:54px;display:flex;align-items:center;justify-content:space-between;box-shadow:var(--shadow-md);flex-shrink:0;}
.logo{font-family:'Syne',sans-serif;font-weight:800;font-size:1.3rem;letter-spacing:-.02em;color:var(--text);}
.logo span{color:var(--accent);}
.logo-sub{font-size:.62rem;color:var(--muted);font-weight:500;letter-spacing:.04em;margin-top:-2px;}
.home-btn{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;border-radius:var(--radius-sm);font-size:.78rem;font-weight:600;color:var(--text2);background:var(--surface2);border:1px solid var(--border2);cursor:pointer;text-decoration:none;transition:all .15s;}
.home-btn:hover{background:var(--accent-light);color:var(--accent);border-color:var(--accent);}

/* ── STEPPER ── */
.stepper{background:var(--white);border-bottom:1px solid var(--border);padding:0 24px;height:46px;display:flex;align-items:center;gap:8px;flex-shrink:0;}
.step{display:flex;align-items:center;gap:8px;padding:5px 14px;border-radius:100px;font-size:.74rem;font-weight:600;color:var(--muted);cursor:default;transition:all .2s;white-space:nowrap;}
.step.active{background:var(--accent-light);color:var(--accent);}
.step.done{color:var(--success);}
.step-num{width:20px;height:20px;border-radius:50%;background:var(--border2);color:var(--white);display:flex;align-items:center;justify-content:center;font-size:.65rem;font-weight:700;flex-shrink:0;}
.step.active .step-num{background:var(--accent);}
.step.done .step-num{background:var(--success);}
.step-arrow{color:var(--border2);font-size:1rem;}

/* ── SCREENS ── */
.screen{display:none;flex:1;overflow:hidden;}
.screen.active{display:flex;flex-direction:column;}

/* ── SECTION LABEL ── */
.section-label{font-size:.68rem;font-weight:700;letter-spacing:.09em;text-transform:uppercase;color:var(--muted);margin-bottom:8px;}

/* ── BUTTONS ── */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:8px 16px;border-radius:var(--radius-sm);font-family:'IBM Plex Sans',sans-serif;font-size:.8rem;font-weight:600;cursor:pointer;transition:all .15s;border:none;white-space:nowrap;}
.btn-primary{background:var(--accent);color:#fff;box-shadow:0 1px 3px rgba(37,99,235,.3);}
.btn-primary:hover{background:var(--accent-hover);transform:translateY(-1px);}
.btn-primary:disabled{background:var(--border2);color:var(--muted);cursor:not-allowed;transform:none;box-shadow:none;}
.btn-success{background:var(--success);color:#fff;box-shadow:0 1px 3px rgba(21,128,61,.25);}
.btn-success:hover{background:#166534;transform:translateY(-1px);}
.btn-success:disabled{background:var(--border2);color:var(--muted);cursor:not-allowed;transform:none;box-shadow:none;}
.btn-secondary{background:var(--white);color:var(--text2);border:1px solid var(--border2);}
.btn-secondary:hover{background:var(--surface2);}
.btn-danger-outline{background:transparent;color:var(--danger);border:1px solid var(--danger-border);}
.btn-danger-outline:hover{background:var(--danger-bg);}
.btn-full{width:100%;}
.btn-lg{padding:11px 22px;font-size:.9rem;}
.btn-sm{padding:4px 10px;font-size:.72rem;}

/* ── SCREEN 1 LAYOUT ── */
.s1-layout{display:grid;grid-template-columns:1fr 1fr;gap:0;flex:1;overflow:hidden;}
.s1-panel{padding:28px 24px;display:flex;flex-direction:column;gap:18px;overflow-y:auto;}
.s1-panel:first-child{border-right:1px solid var(--border);}
.panel-title{font-family:'Syne',sans-serif;font-size:1rem;font-weight:700;color:var(--text);margin-bottom:2px;}
.panel-sub{font-size:.74rem;color:var(--muted);margin-bottom:16px;}

/* ── UPLOAD ZONES ── */
.upload-zone{border:2px dashed var(--border2);border-radius:var(--radius);padding:28px 16px;text-align:center;cursor:pointer;transition:all .2s;background:var(--surface);}
.upload-zone:hover{border-color:var(--accent);background:var(--accent-light);}
.upload-zone.bom-zone{border-color:#93c5fd;background:#eff6ff;}
.upload-zone.bom-zone:hover{border-color:var(--accent);background:var(--accent-light);}
.upload-zone.mrs-zone{border-color:var(--purple-border);background:var(--purple-light);}
.upload-zone.mrs-zone:hover{border-color:var(--purple);background:#ddd6fe;}
.uz-icon{font-size:2rem;margin-bottom:8px;display:block;}
.uz-text{font-size:.8rem;line-height:1.5;}
.uz-text strong{color:var(--accent);}
.mrs-zone .uz-text strong{color:var(--purple);}
.uz-sub{font-size:.68rem;color:var(--muted);margin-top:4px;}

/* File chip */
.file-chip{display:flex;align-items:center;gap:10px;border-radius:var(--radius-sm);padding:10px 14px;border:1px solid;}
.file-chip.bom-chip{background:var(--accent-light);border-color:#93c5fd;}
.file-chip.mrs-chip{background:var(--purple-light);border-color:var(--purple-border);}
.fc-icon{width:32px;height:32px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:.62rem;font-weight:700;font-family:'IBM Plex Mono',monospace;flex-shrink:0;color:#fff;}
.bom-chip .fc-icon{background:var(--accent);}
.mrs-chip .fc-icon{background:var(--purple);}
.fc-info{flex:1;min-width:0;}
.fc-name{font-size:.8rem;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.bom-chip .fc-name{color:var(--accent);}
.mrs-chip .fc-name{color:var(--purple);}
.fc-sub{font-size:.68rem;color:var(--muted);}

/* Column mapping */
.col-map-card{background:var(--white);border:1px solid var(--border);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow);}
.col-map-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:10px;}
.col-map-item{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:7px 10px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-sm);}
.col-map-label{font-size:.74rem;font-weight:600;color:var(--text2);}
.col-input{width:52px;padding:4px 7px;border:1px solid var(--border);border-radius:4px;font-family:'IBM Plex Mono',monospace;font-size:.78rem;text-align:center;outline:none;background:var(--white);color:var(--text);}
.col-input:focus{border-color:var(--accent);}

/* S1 footer */
.s1-footer{padding:16px 24px;background:var(--white);border-top:1px solid var(--border);display:flex;justify-content:flex-end;align-items:center;gap:12px;flex-shrink:0;}

/* ── SCREEN 2 — VISUALIZATION ── */
.s2-layout{display:flex;flex-direction:column;flex:1;overflow:hidden;}
.s2-toolbar{padding:12px 24px;background:var(--white);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px;flex-shrink:0;flex-wrap:wrap;}
.section-pill{display:inline-flex;align-items:center;gap:6px;padding:5px 12px;border-radius:100px;border:1.5px solid var(--border2);background:var(--white);font-size:.72rem;font-weight:600;cursor:pointer;transition:all .15s;color:var(--text2);}
.section-pill:hover{border-color:var(--accent);color:var(--accent);background:var(--accent-light);}
.section-pill.active{border-color:var(--accent);background:var(--accent);color:#fff;}
.s2-content{flex:1;overflow:auto;padding:20px 24px;}
.section-block{background:var(--white);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:16px;overflow:hidden;box-shadow:var(--shadow);}
.section-head{padding:12px 18px;background:var(--surface2);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;}
.section-head h3{font-family:'Syne',sans-serif;font-size:.88rem;font-weight:700;color:var(--text);}
.section-badge{font-size:.62rem;font-weight:700;padding:2px 8px;border-radius:100px;background:var(--accent-light);color:var(--accent);border:1px solid #93c5fd;}
.viz-table{width:100%;border-collapse:collapse;font-size:.75rem;}
.viz-table th{padding:8px 12px;text-align:left;border-bottom:1px solid var(--border);font-size:.64rem;font-weight:700;letter-spacing:.07em;text-transform:uppercase;color:var(--muted);background:var(--surface);white-space:nowrap;}
.viz-table th.section-col-head{background:var(--accent-light);color:var(--accent);text-align:center;}
.viz-table th.panel-head{background:#eff6ff;color:#1d4ed8;text-align:center;}
.viz-table th.mrs-head{background:var(--purple-light);color:var(--purple);text-align:center;}
.viz-table th.status-head{background:var(--surface2);color:var(--text2);text-align:center;}
.viz-table td{padding:8px 12px;border-bottom:1px solid var(--border);vertical-align:middle;}
.viz-table tr:last-child td{border-bottom:none;}
.viz-table tr:hover td{background:var(--surface);}
.td-mono{font-family:'IBM Plex Mono',monospace;font-size:.72rem;}
.td-center{text-align:center;}
.pill-excess{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:100px;font-size:.65rem;font-weight:700;background:var(--success-bg);color:var(--success);border:1px solid var(--success-border);}
.pill-short{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:100px;font-size:.65rem;font-weight:700;background:var(--danger-bg);color:var(--danger);border:1px solid var(--danger-border);}
.pill-exact{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:100px;font-size:.65rem;font-weight:700;background:var(--warning-bg);color:var(--warning);border:1px solid var(--warning-border);}
.pill-nomrs{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:100px;font-size:.65rem;font-weight:700;background:var(--surface2);color:var(--muted);border:1px solid var(--border2);}

/* Stats bar */
.stats-bar{display:flex;gap:12px;margin-bottom:16px;flex-wrap:wrap;}
.stat-card{background:var(--white);border:1px solid var(--border);border-radius:var(--radius-sm);padding:10px 16px;display:flex;align-items:center;gap:10px;box-shadow:var(--shadow);flex:1;min-width:120px;}
.stat-icon{font-size:1.1rem;}
.stat-val{font-family:'Syne',sans-serif;font-size:1.2rem;font-weight:700;color:var(--text);}
.stat-label{font-size:.65rem;color:var(--muted);text-transform:uppercase;letter-spacing:.06em;}

/* ── SCREEN 3 — EXPORT ── */
.s3-layout{display:flex;flex-direction:column;align-items:center;justify-content:center;flex:1;padding:32px;gap:20px;}
.export-card{background:var(--white);border:1px solid var(--border);border-radius:var(--radius);padding:32px 36px;width:100%;max-width:560px;box-shadow:var(--shadow-md);text-align:center;}
.export-card h2{font-family:'Syne',sans-serif;font-size:1.3rem;font-weight:800;color:var(--text);margin-bottom:6px;}
.export-card p{font-size:.78rem;color:var(--muted);margin-bottom:24px;line-height:1.6;}
.export-summary{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:24px;text-align:left;}
.exp-item{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-sm);padding:10px 14px;}
.exp-item-val{font-family:'Syne',sans-serif;font-size:1.1rem;font-weight:700;color:var(--accent);}
.exp-item-label{font-size:.68rem;color:var(--muted);margin-top:2px;}

/* ── DARK MODE ── */
body.dark{
  --bg:#13151f;--white:#1e2235;--surface:#252840;--surface2:#2d3148;
  --border:#363b58;--border2:#444968;--accent:#4f8eff;--accent-light:#1e2d4a;
  --accent-hover:#6aa3ff;--text:#e8eaf2;--text2:#9ba3c0;--muted:#6b7494;
  --success:#22c55e;--success-bg:#0f2d1a;--success-border:#166334;
  --danger:#f87171;--danger-bg:#2d0f0f;--danger-border:#991b1b;
  --warning:#fbbf24;--warning-bg:#2d2008;--warning-border:#854d0e;
  --purple:#a78bfa;--purple-light:#1e1535;--purple-border:#5b21b6;
  --shadow:0 1px 3px rgba(0,0,0,.3);--shadow-md:0 4px 16px rgba(0,0,0,.4);
}
body.dark header{background:#1a1d2e;border-color:#2a2e45;}
body.dark .stepper{background:#1a1d2e;border-color:#2a2e45;}
body.dark .s1-footer{background:#1a1d2e;}
body.dark .upload-zone.bom-zone{background:#1e2d4a;border-color:#2d4a8a;}
body.dark .upload-zone.mrs-zone{background:#1e1535;border-color:#5b21b6;}
body.dark .col-map-card{background:var(--surface);}
body.dark .col-input{background:var(--surface2);color:var(--text);}
body.dark .s2-toolbar{background:#1a1d2e;}
.dark-toggle{display:flex;align-items:center;gap:8px;background:var(--surface2);border:1px solid var(--border);border-radius:100px;padding:5px 12px;cursor:pointer;font-size:.75rem;font-weight:600;color:var(--text2);transition:all .2s;font-family:'IBM Plex Sans',sans-serif;}
.dark-toggle:hover{background:var(--accent-light);color:var(--accent);border-color:var(--accent);}
.dark-toggle-icon{font-size:.9rem;transition:transform .3s;}
body.dark .dark-toggle-icon{transform:rotate(180deg);}

.empty-state{text-align:center;padding:60px 20px;color:var(--muted);}
.empty-state p{font-size:.8rem;margin-top:8px;line-height:1.6;}
